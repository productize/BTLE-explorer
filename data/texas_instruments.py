def ti_print_ir_temp(data):
  ambient = (data[2] + 256*data[3])/128.0
  # TODO target temp
  return "%0.2f" % (ambient)

def ti_print_accel(data):
  x = data[0] / 64.0
  y = data[1] / 64.0
  z = data[2] / -64.0
  return "X:%f,Y:%f,Z:%f" % (x,y,z)

"""
private double extractTargetTemperature(BluetoothGattCharacteristic c, double ambient) {
    Integer twoByteValue = shortSignedAtOffset(c, 0);
	    
    double Vobj2 = twoByteValue.doubleValue();
    Vobj2 *= 0.00000015625; 
	    
    double Tdie = ambient + 273.15;
	    
    double S0 = 5.593E-14;	// Calibration factor
    double a1 = 1.75E-3;
    double a2 = -1.678E-5;
    double b0 = -2.94E-5;
    double b1 = -5.7E-7;
    double b2 = 4.63E-9;
    double c2 = 13.4;
    double Tref = 298.15;
    double S = S0*(1+a1*(Tdie - Tref)+a2*pow((Tdie - Tref),2));
    double Vos = b0 + b1*(Tdie - Tref) + b2*pow((Tdie - Tref),2);
    double fObj = (Vobj2 - Vos) + c2*pow((Vobj2 - Vos),2);
    double tObj = pow(pow(Tdie,4) + (fObj/S),.25);
	    
    return tObj - 273.15;
}
"""

service = dict(
  ti_st_1 = ([0xF0, 0x00, 0xAA, 0x00, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI IR Temperature Sensor"),
  ti_st_2 = ([0xF0, 0x00, 0xAA, 0x10, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Accelerometer"),
  ti_st_3 = ([0xF0, 0x00, 0xAA, 0x20, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Humidity Sensor"),
  ti_st_4 = ([0xF0, 0x00, 0xAA, 0x30, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Magnetometer"),
  ti_st_5 = ([0xF0, 0x00, 0xAA, 0x40, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Barometric Pressure"),
  ti_st_6 = ([0xF0, 0x00, 0xAA, 0x50, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Gyroscope"),
  ti_st_7 = ([0xF0, 0x00, 0xAA, 0x60, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Test"),

  push_butt = ([0xFF, 0xE0], "TI Simple Key"),
)

attr = dict(
  ti_st_11 = ([0xF0, 0x00, 0xAA, 0x01, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI IR Temperature Sensor Data", ti_print_ir_temp),
  ti_st_12 = ([0xF0, 0x00, 0xAA, 0x02, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI IR Temperature Sensor Configuration"),

  ti_st_21 = ([0xF0, 0x00, 0xAA, 0x11, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Accelerometer Data", ti_print_accel),
  ti_st_22 = ([0xF0, 0x00, 0xAA, 0x12, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Accelerometer Configuration"),
  ti_st_23 = ([0xF0, 0x00, 0xAA, 0x13, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Accelerometer Period"),

  ti_st_31 = ([0xF0, 0x00, 0xAA, 0x21, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Humidity Sensor Data"),
  ti_st_32 = ([0xF0, 0x00, 0xAA, 0x22, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Humidity Sensor Configuration"),

  ti_st_41 = ([0xF0, 0x00, 0xAA, 0x31, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Magnetometer Data"),
  ti_st_42 = ([0xF0, 0x00, 0xAA, 0x32, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Magnetometer Configuration"),
  ti_st_43 = ([0xF0, 0x00, 0xAA, 0x33, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Magnetometer Period"),

  ti_st_51 = ([0xF0, 0x00, 0xAA, 0x41, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Barometric Pressure Data"),
  ti_st_52 = ([0xF0, 0x00, 0xAA, 0x42, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Barometric Pressure Configuration"),
  ti_st_53 = ([0xF0, 0x00, 0xAA, 0x43, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Barometric Pressure Calibration"),

  ti_st_61 = ([0xF0, 0x00, 0xAA, 0x51, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Gyroscope Data"),
  ti_st_62 = ([0xF0, 0x00, 0xAA, 0x52, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Gyroscope Configuration"),

  ti_st_71 = ([0xF0, 0x00, 0xAA, 0x61, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Test Data"),
  ti_st_72 = ([0xF0, 0x00, 0xAA, 0x62, 0x04, 0x51, 0x40, 0x00, 0xB0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00], "TI Test Configuration"),

  push_butt_data = ([0xFF, 0xE1], "TI Simple Key Data"),
)

class Vendor:

  ids = []
